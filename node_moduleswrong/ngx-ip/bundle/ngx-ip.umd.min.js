!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common"),require("@angular/animations"),require("@angular/forms")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","@angular/animations","@angular/forms"],e):e(t.ngxIp=t.ngxIp||{},t.ng.core,t.ng.common,t.ng.animations,t.ng.forms)}(this,function(t,e,n,i,o){"use strict";function r(t){return null!=t&&""+t!="false"}function s(t){t.preventDefault(),t.stopPropagation()}var a=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),l=function(){},c=/^([01]?[0-9]?[0-9]|2[0-4][0-9]|25[0-5])$/,p={BLOCK_COUNT:4,SEP:".",RE_CHAR:/^[0-9]$/,RE_BLOCK:[c,c,c,c],blocks:function(){return["","","",""]},fromBlocks:function(t,e){return void 0===e&&(e=p.SEP),t.join(e)},split:function(t,e,n){if(void 0===e&&(e=p.SEP),void 0===n&&(n=!1),!t)return p.blocks();var i=t.split(e);if(n&&i.length!==p.BLOCK_COUNT)throw new Error("Invalid IPV4");return i},isValid:function(t){return t.every(function(t){return parseInt(t,10)>=0&&parseInt(t,10)<=255})},isMaxLen:function(t){return 3===t.length||2===t.length&&parseInt(t,10)>25}},u=Object.assign(Object.create(p),{BLOCK_COUNT:5,RE_BLOCK:p.RE_BLOCK.concat([/^([0-2]?[0-9]|30)$/]),blocks:function(){return["","","","",""]},fromBlocks:function(t,e){return void 0===e&&(e=p.SEP),t.slice(0,4).join(e)+"/"+t[4]},split:function(t,e,n){if(void 0===e&&(e=p.SEP),void 0===n&&(n=!1),!t)return u.blocks();var i=t.split(e);if(i.push.apply(i,i.pop().split("/")),n&&i.length!==u.BLOCK_COUNT)throw new Error("Invalid IPV4 with Mask");return i},isValid:function(t){for(var e=0;e<4;e++){var n=parseInt(t[e],10);if(!(n>=0&&n<=255))return!1}var i=parseInt(t[4],10);return i>=0&&i<=30},isMaxLen:function(t){return 3===t.length||2===t.length&&parseInt(t,10)>25}}),d=/^[0-9A-Fa-f]{0,4}$/,h={BLOCK_COUNT:8,SEP:":",RE_CHAR:/^[0-9A-Fa-f]$/,RE_BLOCK:p.RE_BLOCK.map(function(t){return d}).concat(p.RE_BLOCK.map(function(t){return d})),blocks:function(){return p.blocks().concat(p.blocks())},fromBlocks:function(t,e){return void 0===e&&(e=h.SEP),t.map(function(t){return t||"0000"}).join(e)},split:function(t,e,n){if(void 0===e&&(e=h.SEP),void 0===n&&(n=!1),!t)return h.blocks();var i=t.split(e+e),o=i[0].split(e);if(2===i.length){var r=i[1].split(e),s=h.BLOCK_COUNT-(o.length+r.length);o.splice.apply(o,[o.length,0].concat(h.blocks().slice(0,s))),o.splice.apply(o,[o.length,0].concat(r))}if(n&&(i.length>2||o.length!==h.BLOCK_COUNT))throw new Error("Invalid IPV6");return o},isValid:function(t){return t.every(function(t){return d.test(t)})&&t.some(function(t){return!!t})},isMaxLen:function(t){return 4===t.length}},f=/^[0-9A-Fa-f]{1,2}$/,g=Object.assign(Object.create(h),{BLOCK_MAX_LEN:2,BLOCK_COUNT:6,RE_BLOCK:p.RE_BLOCK.map(function(t){return f}).concat([f,f]),blocks:function(){return["","","","","",""]},fromBlocks:function(t,e){return void 0===e&&(e=g.SEP),t.join(e)},split:function(t,e,n){if(void 0===e&&(e=g.SEP),void 0===n&&(n=!1),!t)return g.blocks();var i=t.split(e);if(n&&i.length!==g.BLOCK_COUNT)throw new Error("Invalid MAC address");return i},isValid:function(t){return t.every(function(t){return f.test(t)})&&t.some(function(t){return!!t})},isMaxLen:function(t){return 2===t.length}}),y=function(t,e){return t?t.value.substr(0,t.selectionStart)+e+t.value.substr(t.selectionEnd):e},b=function(t){return!!t&&(t.selectionStart===t.selectionEnd&&t.selectionStart===t.value.length)},m=function(t){return 0===t.selectionStart&&t.selectionEnd===t.value.length},v=!!document.queryCommandSupported("copy")||null,C={ipv6:h,mac:g,ipv4WithMask:u,ipv4:p},x=function(){function t(t){this._cdr=t,this.inputValidation="block",this.disabledBlocks=[],this.change=new e.EventEmitter,this.errorCount=0,this.emptyFlag=0,this.fullBlocks=0,this._required=!1,this._readonly=!1,this._disabled=!1,this._value=null,this._onTouchedCallback=l,this._onChangeCallback=l,this.mode="ipv4"}return Object.defineProperty(t.prototype,"mode",{get:function(){return this._mode},set:function(t){if(this._mode!==t){var e=!this.addr||this.separator===this.addr.SEP;if(this.addr=C[t],!this.addr)throw new Error("Unknown mode "+t);e&&(this.separator=this.addr.SEP),this._mode=t,this.blocks=this.addr.blocks(),this.blocksRef=[],this.invalidBlocks=[],this.fullBlocks=0;for(var n=0;n<this.addr.BLOCK_COUNT;n++)this.fullBlocks|=1<<n+1,this.blocksRef[n]=n,this.invalidBlocks[n]=!1}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){t!==this._value&&(this._value=t,this.blocks=this.toBlocks(t),this.markValidity(),this._onChangeCallback(t),this._cdr.markForCheck(),this._cdr.detectChanges())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"copyMode",{get:function(){switch(this.autoCopy){case"DEFAULT_ADDRESS":return"address";case"DEFAULT_BLOCK":return"block";default:return"select"}},set:function(t){switch(!1===v&&"select"===t&&(t=undefined),t){case"select":this.autoCopy=undefined;break;case"address":this.autoCopy="DEFAULT_ADDRESS";break;default:this.autoCopy="DEFAULT_BLOCK"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"separator",{get:function(){return this._separator},set:function(t){this._separator=t,this.separatorMap=this.addr.blocks().map(function(e){return t}),this.separatorMap[this.addr.BLOCK_COUNT-1]="",this.addr===u&&(this.separatorMap[this.addr.BLOCK_COUNT-2]="/")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){this._disabled=r(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readonly",{get:function(){return this._readonly},set:function(t){this._readonly=r(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"required",{get:function(){return this._required},set:function(t){this._required=r(t)},enumerable:!0,configurable:!0}),t.prototype.ngOnChanges=function(t){"separator"in t&&(t.separator.currentValue?this.separator.length>1&&(this.separator=this.separator[0]):this.separator=this.addr.SEP)},t.prototype.isBlockDisabled=function(t){return this.disabled||this.disabledBlocks[t]},t.prototype.validate=function(t){return this.required&&this.fullBlocks===this.emptyFlag?{required:!0}:this.errorCount>0?{NgxIpControl:"Invalid address"}:null},t.prototype.writeValue=function(t){this._value=t,this.blocks=this.toBlocks(t),this.markValidity(),this._cdr.markForCheck(),this._cdr.detectChanges()},t.prototype.registerOnChange=function(t){this._onChangeCallback=t},t.prototype.registerOnTouched=function(t){this._onTouchedCallback=t},t.prototype.getUserCopyMethod=function(){return Promise.resolve("block")},t.prototype.onCopy=function(t,e){var n=this;switch(v){case"TEST":return void(v=!0);case!0:break;case!1:return;case null:if(v="TEST",document.execCommand("copy"),!0!==v)return void(v=!1);break;default:return}try{switch(this.autoCopy){case"block":this.autoCopy=undefined;case"DEFAULT_BLOCK":return;case"address":this.autoCopy=undefined;case"DEFAULT_ADDRESS":var i=this.fromBlocks(this.blocks);t.clipboardData.setData("text",i),s(t);break;case"IN_FLIGHT":s(t);break;default:s(t),m(t.target)&&(this.autoCopy="IN_FLIGHT",this.getUserCopyMethod().then(function(t){n.autoCopy="address"===t?"address":"block",n.copyUserSelectedMethod(e)})["catch"](function(t){return n.autoCopy=undefined}))}}catch(o){}},t.prototype.onPaste=function(t,e){try{var n=t.clipboardData.getData("text");this.paste(n,e)}catch(i){}s(t)},t.prototype.onChange=function(t,e){this.blocks[e]!==t&&(this.blocks[e]=t,this.markValidity(),this.notifyChange(this.fromBlocks(this.blocks)))},t.prototype.onKeyPress=function(t,e){var n=this;if(!(t.metaKey||t.ctrlKey||t.altKey)){var i="string"==typeof t.key?t.key:String.fromCharCode(t.charCode);if("Tab"!==i){if(i===this.separator)s(t),this.focusNext(e);else if(this.isBackspace(t))return this.onKeyUp(t,e);var o=b(t.target),r=y(t.target,i);if("char"===this.inputValidation&&!this.addr.RE_CHAR.test(i))return s(t);if("block"===this.inputValidation&&!this.addr.RE_BLOCK[e].test(r))return s(t);this.markBlockValidity(r,e),!this.invalidBlocks[e]&&o&&this.addr.isMaxLen(r)&&setTimeout(function(){return n.focusNext(e,!1)})}}},t.prototype.onKeyUp=function(t,e){if(this.isBackspace(t)){var n=t.target,i=n&&n.selectionStart>=0&&n.selectionEnd>n.selectionStart?n.value.substr(0,n.selectionStart)+n.value.substr(n.selectionEnd):n.value.substr(0,n.value.length-1);this.markBlockValidity(i,e)}},t.prototype.onBlur=function(t){this.focused=!1},t.prototype.onFocus=function(t){this.readonly||(this.focused=!0)},t.prototype.isBackspace=function(t){return 8===t.keyCode||"Backspace"===t.key},t.prototype.getInputElement=function(t){var e=this.inputs.toArray()[t];return e&&e.nativeElement},t.prototype.paste=function(t,e){var n=this.addr.split(t,this.separator);if(n.length===this.addr.BLOCK_COUNT)this.value=this.fromBlocks(n);else{var i=y(this.getInputElement(e),n[0]);this.onChange(i,e)}return!0},t.prototype.reset=function(){this.errorCount=0;for(var t=0;t<this.addr.BLOCK_COUNT;t++)this.invalidBlocks[t]=!1},t.prototype.markValidity=function(){for(var t=0;t<this.addr.BLOCK_COUNT;t++)this.markBlockValidity(this.blocks[t],t);this.fullBlocks===this.emptyFlag&&this.reset()},t.prototype.markBlockValidity=function(t,e){t?this.emptyFlag&=this.emptyFlag-(1<<e+1):this.emptyFlag|=1<<e+1;var n=!!this.invalidBlocks[e];this.invalidBlocks[e]=!this.addr.RE_BLOCK[e].test(t),4!==e||this.addr!==u||this.invalidBlocks[e]||(this.invalidBlocks[e]=parseInt(t,10)<0),n&&!this.invalidBlocks[e]?this.errorCount--:!n&&this.invalidBlocks[e]&&this.errorCount++},t.prototype.focusNext=function(t,e){void 0===e&&(e=!0);var n=this.getInputElement(t+1);n&&(n.focus(),e&&this.blocks[t+1]&&n.setSelectionRange(0,this.blocks[t+1].toString().length))},t.prototype.toBlocks=function(t){return this.addr.split(t,this.separator)},t.prototype.fromBlocks=function(t){return this.fullBlocks===this.emptyFlag?"":this.addr.fromBlocks(t,this.separator)},t.prototype.copyUserSelectedMethod=function(t){try{var e=this.getInputElement(t);e&&e.select&&e.select(),document.execCommand("copy")}catch(n){this.autoCopy="DEFAULT_BLOCK"}},t.prototype.notifyChange=function(t){this._onChangeCallback(t),this.change.emit(t)},t}();x.propDecorators={mode:[{type:e.Input}],value:[{type:e.Input}],copyMode:[{type:e.Input}],separator:[{type:e.Input}],inputValidation:[{type:e.Input}],disabledBlocks:[{type:e.Input}],disabled:[{type:e.Input}],readonly:[{type:e.Input}],required:[{type:e.Input}],change:[{type:e.Output}],inputs:[{type:e.ViewChildren,args:["input",{read:e.ElementRef}]}]};var k={provide:o.NG_VALUE_ACCESSOR,useExisting:e.forwardRef(function(){return B}),multi:!0},_={provide:o.NG_VALIDATORS,useExisting:e.forwardRef(function(){return B}),multi:!0},B=function(t){function e(e){var n=t.call(this,e)||this;return n.containerClass=[],n._highlightInvalidBlocks=!0,n._theme="",n}return a(e,t),Object.defineProperty(e.prototype,"highlightInvalidBlocks",{get:function(){return this._highlightInvalidBlocks},set:function(t){this._highlightInvalidBlocks!==t&&(this._highlightInvalidBlocks=t,this.markValidity())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return this.containerClass.indexOf("ngx-ip-focused")>-1},set:function(t){var e=this.containerClass.indexOf("ngx-ip-focused");t&&-1===e?this.containerClass.push("ngx-ip-focused"):!t&&e>-1&&this.containerClass.splice(e,1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"theme",{get:function(){return this._theme},set:function(t){if(this._theme!==t){var e=this.containerClass.indexOf(this._theme);e>-1&&this.containerClass.splice(e,1),this._theme=t,t&&this.containerClass.push(t)}},enumerable:!0,configurable:!0}),e.prototype.onCopyDecision=function(t){var e=this.resolveCopyMethod;this.resolveCopyMethod=this.inputAnim=undefined,e&&e(t)},e.prototype.getUserCopyMethod=function(){var t=this;return this.inputAnim="hide",new Promise(function(e){return t.resolveCopyMethod=e})},e}(x);B.decorators=[{type:e.Component,args:[{selector:"ngx-ip",template:'<div class="ngx-ip-container" [ngClass]="containerClass">\n  <div class="ngx-ip-table" [@inputAnim]="inputAnim">\n    <ng-template ngFor let-idx [ngForOf]="blocksRef"; let-isLast="last">\n      <div class="ngx-ip-table-cell"\n           [class.ngx-ip-disabled]="isBlockDisabled(idx)"\n           [ngClass]="{ \'ngx-ip-error\': highlightInvalidBlocks && invalidBlocks[idx] }">\n        <input #input\n               type="text"\n               [required]="required"\n               [readonly]="readonly"\n               [value]="blocks[idx] || \'\'"\n               (change)="onChange($event.target.value, idx)"\n               (blur)="onBlur(idx)"\n               (focus)="onFocus(idx)"\n               [disabled]="isBlockDisabled(idx)"\n               (paste)="onPaste($event, idx)"\n               (copy)="onCopy($event, idx)"\n               (keypress)="onKeyPress($event, idx)"\n               (keyup)="onKeyUp($event, idx)"/>\n      </div>\n      <span class="ngx-ip-table-cell ngx-ip-sep">{{separatorMap[idx]}}</span>\n    </ng-template>\n  </div>\n\n  <div class="ngx-ip-copy-overlay" *ngIf="resolveCopyMethod">\n    <div class="ngx-ip-table" [@copyAnim]="">\n      <div class="ngx-ip-copy-title">Copy?</div>\n      <a (click)="onCopyDecision(\'block\')">Block</a>\n      <a (click)="onCopyDecision(\'address\')">Address</a>\n    </div>\n  </div>\n</div>\n',styles:[".ngx-ip-container {\n  position: relative;\n  margin: 5px 0;\n  padding: 2px 0;\n  overflow: hidden;\n}\n\n.ngx-ip-copy-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n\n.ngx-ip-copy-overlay .ngx-ip-table {\n  height: 100%;\n}\n\n.ngx-ip-copy-overlay .ngx-ip-table > * {\n  display: table-cell;\n  text-align: center;\n  vertical-align: middle;\n}\n\n.ngx-ip-copy-title {\n  text-align: center;\n  vertical-align: middle;\n  font-size: 0.75em;\n}\n\n.ngx-ip-copy-overlay .ngx-ip-table > a {\n  border: 1px solid #9e9e9e;\n  cursor: pointer;\n}\n\n\n\n.ngx-ip-table {\n  display: inline-table;\n  flex-flow: column;\n  vertical-align: bottom;\n  width: 100%;\n}\n\n.ngx-ip-table-cell {\n  position: relative;\n  display: table-cell;\n  text-align: center;\n}\n\n.ngx-ip-table input {\n  text-align: center;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n/* Default Theme */\n.ngx-ip-theme-default.ngx-ip-container {\n  border: 1px solid #26a69a;\n}\n\n\n.ngx-ip-theme-default .ngx-ip-table-cell {\n  transition: all 0.3s;\n}\n\n.ngx-ip-theme-default .ngx-ip-table input {\n  background: transparent;\n  border: none;\n  outline: none;\n}\n\n.ngx-ip-theme-default .ngx-ip-table-cell.ngx-ip-error {\n  box-shadow: 0 2px 15px 0 #F44336;\n}\n\n/* Boxed Theme */\n.ngx-ip-theme-boxed input {\n  transition: all 0.3s;\n}\n.ngx-ip-theme-boxed .ngx-ip-error:not(.ngx-ip-disabled) input {\n  border-color: #F44336;\n}\n\n\n/* MATERIAL THEME */\n.ngx-ip-theme-material.ngx-ip-container {\n  background-color: transparent;\n  border: none;\n  box-sizing: content-box;\n  transition: all 0.3s;\n  font-size: 1rem;\n}\n\n.ngx-ip-theme-material .ngx-ip-table-cell {\n  border-bottom: 1px solid #9e9e9e;\n  transition: all 0.3s;\n}\n\n.ngx-ip-theme-material.ngx-ip-focused .ngx-ip-table-cell:not(.ngx-ip-disabled) {\n  border-bottom: 1px solid #26a69a;\n  box-shadow: 0 1px 0 0 #26a69a;\n}\n\n\n.ngx-ip-theme-material .ngx-ip-table-cell.ngx-ip-error:not(.ngx-ip-disabled) {\n  box-shadow: 0 1px 0 0 #F44336;\n}\n\n.ngx-ip-theme-material .ngx-ip-table-cell.ngx-ip-disabled {\n  border-bottom: 1px dotted rgba(0,0,0,0.26);\n}\n\n.ngx-ip-theme-material input {\n  background: transparent;\n  border: none;\n  outline: none;\n\n  height: 3rem;\n  font-size: 1rem;\n  padding: 0;\n  box-shadow: none;\n}\n\n.ngx-ip-theme-material input[disabled] {\n  color: rgba(0,0,0,0.26);\n}\n"],encapsulation:e.ViewEncapsulation.None,changeDetection:e.ChangeDetectionStrategy.OnPush,providers:[k,_],animations:[i.trigger("copyAnim",[i.transition("void => *",[i.style({transform:"translateY(-100%)"}),i.animate("0.25s")]),i.transition("* => void",[i.animate("0.25s",i.style({transform:"translateY(-100%)"}))])]),i.trigger("inputAnim",[i.state("hide",i.style({opacity:0})),i.transition("* => hide",[i.animate("0.25s",i.style({transform:"translateY(100%)"}))]),i.transition("hide => *",[i.style({transform:"translateY(100%)"}),i.animate("0.25s")])])]}]}],B.ctorParameters=function(){return[{type:e.ChangeDetectorRef}]},B.propDecorators={highlightInvalidBlocks:[{type:e.Input}],theme:[{type:e.Input}]};var O=function(){return function(){}}();O.decorators=[{type:e.NgModule,args:[{declarations:[B],imports:[n.CommonModule],exports:[B]}]}],O.ctorParameters=function(){return[]},t.NgxIpModule=O,t.NgxIpComponent=B,t.NgxIpBase=x,t.ɵb=_,t.ɵa=k,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-ip.umd.js.map